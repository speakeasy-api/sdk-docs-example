###### heading

## Single Sign-On

The Single Sign-On API has been modeled to meet the [OAuth 2.0](#OAuth) framework specification.
As a result, authentication flows constructed using the Single Sign-On API replicate the OAuth 2.0 protocol flow.

### Redirect URI

In the [OAuth 2.0](#OAuth) protocol, a redirect URI is the location your user is redirected to once they have successfully authenticated with their Identity Provider.

In Production Environments, the redirect URI to your application must use HTTPS
and there should be at least one redirect URI configured and selected as a default
for a WorkOS Environment. This can be done from the [SSO Configuration](https://#SSO)
page in the WorkOS dashboard. Without a valid redirect URI, users will be unable to sign in.

Redirect URIs that use HTTP and localhost are allowed in Sandbox Environments.

```curl.EMPTY copy filename="Example Redirect URI"
    https://your-app.com/callback?code=01E2RJ4C05B52KKZ8FSRDAP23J&state=dj1kUXc0dzlXZ1hjUQ==
```

### Get Authorization URL

Generate an OAuth 2.0 authorization URL.

WorkOS generates an OAuth 2.0 authorization URL that automatically directs a user to their Identity Provider.
Once the user authenticates with their Identity Provider, WorkOS then issues a redirect to your [Redirect URI](#redirectURI)
to complete the login flow.

To indicate the connection to use for authentication, use one of the following connection selectors:
connection, organization, or provider.

These connection selectors are mutually exclusive, and exactly one must be provided.

```php copy filename="Request / Response"
<?php
    WorkOS\WorkOS::setApiKey("sk_example_123456789");
    WorkOS\WorkOS::setClientId("sk_example_123456789");

    $sso = new WorkOS\SSO();
    $authorizationUrl = $sso->getAuthorizationUrl(
        redirectUri: "https://your-app.com/callback",
        state: "dj1kUXc0dzlXZ1hjUQ==",
        connection: "conn_01E4ZCR3C56J083X43JQXF3JK5"
);
```

##### Error codes

If there is an issue generating an authorization URL, WorkOS will issue a redirect with an error query parameter,
an error_description query parameter with additional information, and the original state parameter (if provided).
Possible error codes are listed below.

| Code                                    | Description                                                             |
|-----------------------------------------|-------------------------------------------------------------------------|
| <span className={'default'}>ambiguous_connection_selector</span>  | A Connection could not be uniquely identified using the provided connection selector (e.g., organization). This can occur when there are multiple SSO Connections under the same Organization. If you need multiple SSO Connections for an Organization, use the connection parameter to identify which Connection to use for SSO.|
| <span className={'default'}>connection_domain_invalid</span>  | There is no Connection for the provided domain. |
| <span className={'default'}>connection_invalid</span>  | There is no Connection for the provided ID.            |
| <span className={'default'}>connection_strategy_invalid</span>  | The Provider has multiple strategies associated per environment. |
| <span className={'default'}>connection_unlinked</span>  | The Connection associated with the request is unlinked. |
| <span className={'default'}>domain_connection_selector_not_allowed</span>    | This is a legacy error code that only applies if using the deprecated “domain” query parameter which is no longer valid for the Get Authorization URL endpoint. Use the “organization” or “connection” query parameters to target a connection instead. |
| <span className={'default'}>invalid_connection_selector</span>  | A valid connection selector query parameter must be provided in order to correctly determine the proper Connection to return an authorization URL for. Valid connection selectors are either connection, organization, or provider. |
| <span className={'default'}>organization_invalid</span>  | There is no Organization for the provided ID. |
| <span className={'default'}>profile_not_allowed_outside_organization</span>  | A Profile was received that has an email that is outside the Organization's [User Email Domains](/reference/resources/pets/dogs/create_pets) and the Organization does not allow this. To resolve this, either add the missing domain to the Organization's User Email Domains or configure the Organization to allow profiles outside of it. |
| <span className={'default'}>server_error</span>  | The SSO Authentication failed for a user. More detailed errors and steps to resolve are available in the [Sessions tab](/reference/resources/pets/dogs/create_pets) on the connection page in the WorkOS Dashboard. |



